<div ng-controller="MainController as mainCtrl">
  <div ng-if="mainCtrl.notice" class="alert alert-success alert-dismissible" role="alert">
    {{mainCtrl.notice}}
  </div>
  <div ng-if="mainCtrl.alert" class="alert alert-danger alert-dismissible" role="alert">
    {{mainCtrl.alert}}
  </div>
  <div ng-if="mainCtrl.pokerTables.length == 0" class="alert alert-warning alert-dismissible" role="alert">
    <strong>Sorry</strong>, but there are no available poker tables at the moment.
  </div>

  <div id="error_explanation" ng-if="mainCtrl.errors.length > 0" class="alert alert-info" role="alert">
    <span><strong>User was not updated:</strong></span>
    <ul>
      <li ng-repeat="error in mainCtrl.errors">{{error}}</li>
    </ul>
  </div>

  <form class="form-signin" ng-submit="mainCtrl.submitForm()">
    <h2>Enter your email</h2>
    <label for="inputEmail" class="sr-only">Email address</label>
    <%= fields_for :user do |user_fields| %>
        <%= user_fields.email_field :email,
                                    class: 'form-control',
                                    placeholder: 'Email address',
                                    'ng-model': 'mainCtrl.user.email',
                                    required: true,
                                    autofocus: true %>
    <% end %>
    <ul class="checkbox list-group">
      <li class="list-group-item" ng-repeat="pokerTable in mainCtrl.pokerTables">
        <label>
          <input type="checkbox" checklist-model="mainCtrl.user.poker_table_ids" checklist-value="pokerTable.id">
          {{pokerTable.name}}
        </label>
      </li>
    </ul>
    <div ng-if="!(mainCtrl.pokerTables.length != 0)">
      <%= submit_tag 'Add user', class: 'btn btn-lg btn-primary btn-block' %>
    </div>
    <div ng-if="mainCtrl.pokerTables.length != 0">
      <%= submit_tag 'Add tables', class: 'btn btn-lg btn-primary btn-block' %>
    </div>
  </form>
</div>